{"version":3,"file":"fsts.min.js","sources":["../lib/JS.js","../lib/logger/ConsoleLogger.js","../lib/logger/index.js","../lib/Device.js","../lib/cache/LocalStorage.js","../lib/cache/MemoryStorage.js","../lib/cache/index.js","../lib/sso/Google.js","../lib/sso/Facebook.js","../lib/sso/LinkedIn.js","../lib/sso/index.js","../lib/pipe/Subscriber.js","../lib/pipe/Channel.js","../lib/pipe/Pipe.js","../lib/pipe/index.js","../lib/Url.js"],"sourcesContent":["var JS = function () {\n    function JS() {\n        babelHelpers.classCallCheck(this, JS);\n    }\n\n    babelHelpers.createClass(JS, null, [{\n        key: 'isString',\n\n        // String\n        value: function isString(val) {\n            return typeof val === 'string';\n        }\n    }, {\n        key: 'padNumber',\n        value: function padNumber(n, length) {\n            if (n < 0) {\n                return '-' + JS.padNumber(-n, length - 1);\n            }\n\n            var cur = n % 10;\n            var remain = Math.floor(n / 10);\n            var s = '' + cur;\n            for (var i = 1; i < length; i++) {\n                if (remain === 0) {\n                    s = '0' + s;\n                } else {\n                    cur = remain % 10;\n                    remain = Math.floor(remain / 10);\n                    s = '' + cur + s;\n                }\n            }\n\n            return s;\n        }\n\n        // Object\n\n    }, {\n        key: 'lessProps',\n        value: function lessProps(props, less) {\n            var p = Object.assign({}, props);\n            if (!less) {\n                return p;\n            }\n\n            var list = [].concat(less);\n            list.forEach(function (prop) {\n                if (typeof prop === 'string') {\n                    var regex = new RegExp('^' + prop + '$');\n                    Object.keys(props).map(function (key) {\n                        if (key.match(regex)) {\n                            delete p[key];\n                        }\n                    });\n                }\n            });\n\n            return p;\n        }\n    }, {\n        key: 'hasProps',\n        value: function hasProps(props, lookup) {\n            if (!lookup) {\n                return 0;\n            }\n\n            var count = 0;\n            var list = [].concat(lookup);\n            list.forEach(function (prop) {\n                if (typeof prop === 'string') {\n                    var regex = new RegExp('^' + prop + '$');\n                    Object.keys(props).map(function (key) {\n                        if (key.match(regex)) {\n                            count++;\n                        }\n                    });\n                }\n            });\n\n            return count;\n        }\n    }, {\n        key: 'traverseProps',\n        value: function traverseProps(obj, callback) {\n            if (!callback) {\n                console.log('no callback for traverse, do nothing');\n                return;\n            }\n\n            JS._traverseProps([], obj, callback);\n        }\n    }, {\n        key: '_traverseProps',\n        value: function _traverseProps(path, obj, callback) {\n            if ((typeof obj === 'undefined' ? 'undefined' : babelHelpers.typeof(obj)) !== 'object') {\n                return;\n            }\n\n            Object.keys(obj).forEach(function (key) {\n                var val = obj[key];\n                callback(path, key, val);\n                JS._traverseProps(path.concat(key), val, callback);\n            });\n        }\n\n        // Array\n\n    }, {\n        key: 'isArray',\n        value: function isArray(val) {\n            if ((typeof val === 'undefined' ? 'undefined' : babelHelpers.typeof(val)) !== 'object') {\n                return false;\n            }\n\n            return typeof val.length === 'number';\n        }\n    }, {\n        key: 'sureArray',\n        value: function sureArray(ary) {\n            return [].concat(ary);\n        }\n    }, {\n        key: 'appendUnique',\n        value: function appendUnique(ary, val) {\n            if (!ary) {\n                return false;\n            }\n\n            var exists = ary.filter(function (item) {\n                return item === val;\n            });\n            if (exists.length > 0) {\n                return false;\n            }\n\n            ary.push(val);\n            return true;\n        }\n\n        // Date Time\n\n    }, {\n        key: 'ts',\n        value: function ts() {\n            return new Date().getTime();\n        }\n\n        // General\n\n    }, {\n        key: 'isUndefined',\n        value: function isUndefined(val) {\n            return typeof val === 'undefined';\n        }\n    }, {\n        key: 'undefinedThen',\n        value: function undefinedThen(val, defVal) {\n            return JS.isUndefined(val) ? defVal : val;\n        }\n    }]);\n    return JS;\n}();\n\nexport default JS;","import JS from '../JS';\n\nvar LOG_LEVELS = {\n    VERBOSE: 1,\n    DEBUG: 2,\n    INFO: 3,\n    WARN: 4,\n    ERROR: 5\n};\n\nvar ConsoleLogger = function () {\n    function ConsoleLogger(name) {\n        var level = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'WARN';\n        babelHelpers.classCallCheck(this, ConsoleLogger);\n\n        this.name = name;\n        this.level = level;\n    }\n\n    babelHelpers.createClass(ConsoleLogger, [{\n        key: '_ts',\n        value: function _ts() {\n            var dt = new Date();\n            return [JS.padNumber(dt.getMinutes(), 2), JS.padNumber(dt.getSeconds(), 2)].join(':') + '.' + dt.getMilliseconds();\n        }\n    }, {\n        key: '_key',\n        value: function _key(type, msg) {\n            var parts = ['[' + type + ']', this._ts(), this.name];\n\n            if (msg) {\n                parts = parts.concat(['-', msg]);\n            }\n\n            return parts.join(' ');\n        }\n    }, {\n        key: '_log',\n        value: function _log(type) {\n            var level_name = this.level;\n            if (ConsoleLogger.LOG_LEVEL) {\n                level_name = ConsoleLogger.LOG_LEVEL;\n            }\n            if (typeof window != 'undefined' && window.LOG_LEVEL) {\n                level_name = window.LOG_LEVEL;\n            }\n            var logger_level = LOG_LEVELS[level_name];\n            var type_level = LOG_LEVELS[type];\n            if (!(type_level >= logger_level)) {\n                return;\n            }\n\n            var log = console.log;\n            if (type === 'ERROR' && console.error) {\n                log = console.error;\n            }\n            if (type === 'WARN' && console.warn) {\n                log = console.warn;\n            }\n\n            for (var _len = arguments.length, msg = Array(_len > 1 ? _len - 1 : 0), _key2 = 1; _key2 < _len; _key2++) {\n                msg[_key2 - 1] = arguments[_key2];\n            }\n\n            if (msg.length === 1 && typeof msg[0] === 'string') {\n                log(this._key(type, msg[0]));\n            } else if (msg.length === 1) {\n                var output = {};\n                var key = this._key(type);\n                output[key] = msg[0];\n                log(output);\n            } else if (typeof msg[0] === 'string') {\n                var obj = msg.slice(1);\n                if (obj.length === 1) {\n                    obj = obj[0];\n                }\n                var _output = {};\n                var _key3 = this._key(type, msg[0]);\n                _output[_key3] = obj;\n                log(_output);\n            } else {\n                var _output2 = {};\n                var _key4 = this._key(type);\n                _output2[_key4] = msg;\n                log(_output2);\n            }\n        }\n    }, {\n        key: 'log',\n        value: function log() {\n            for (var _len2 = arguments.length, msg = Array(_len2), _key5 = 0; _key5 < _len2; _key5++) {\n                msg[_key5] = arguments[_key5];\n            }\n\n            this._log.apply(this, ['INFO'].concat(msg));\n        }\n    }, {\n        key: 'info',\n        value: function info() {\n            for (var _len3 = arguments.length, msg = Array(_len3), _key6 = 0; _key6 < _len3; _key6++) {\n                msg[_key6] = arguments[_key6];\n            }\n\n            this._log.apply(this, ['INFO'].concat(msg));\n        }\n    }, {\n        key: 'warn',\n        value: function warn() {\n            for (var _len4 = arguments.length, msg = Array(_len4), _key7 = 0; _key7 < _len4; _key7++) {\n                msg[_key7] = arguments[_key7];\n            }\n\n            this._log.apply(this, ['WARN'].concat(msg));\n        }\n    }, {\n        key: 'error',\n        value: function error() {\n            for (var _len5 = arguments.length, msg = Array(_len5), _key8 = 0; _key8 < _len5; _key8++) {\n                msg[_key8] = arguments[_key8];\n            }\n\n            this._log.apply(this, ['ERROR'].concat(msg));\n        }\n    }, {\n        key: 'debug',\n        value: function debug() {\n            for (var _len6 = arguments.length, msg = Array(_len6), _key9 = 0; _key9 < _len6; _key9++) {\n                msg[_key9] = arguments[_key9];\n            }\n\n            this._log.apply(this, ['DEBUG'].concat(msg));\n        }\n    }, {\n        key: 'verbose',\n        value: function verbose() {\n            for (var _len7 = arguments.length, msg = Array(_len7), _key10 = 0; _key10 < _len7; _key10++) {\n                msg[_key10] = arguments[_key10];\n            }\n\n            this._log.apply(this, ['VERBOSE'].concat(msg));\n        }\n    }]);\n    return ConsoleLogger;\n}();\n\nexport default ConsoleLogger;\n;","import ConsoleLogger from './ConsoleLogger';\n\nvar Logger = ConsoleLogger;\n\nexport default Logger;","var Device = function () {\n    function Device() {\n        babelHelpers.classCallCheck(this, Device);\n    }\n\n    babelHelpers.createClass(Device, null, [{\n        key: 'hasWindow',\n        value: function hasWindow() {\n            return typeof window !== 'undefined';\n        }\n    }, {\n        key: 'createScript',\n        value: function createScript(src, async, onload) {\n            var script = document.createElement('script');\n            script.src = src;\n            script.async = true;\n            script.onload = onload;\n            document.body.appendChild(script);\n        }\n    }]);\n    return Device;\n}();\n\nexport default Device;","import JS from '../JS';\nimport Logger from '../logger';\n\nvar logger = new Logger('LocalStorage');\n\nvar defaultOptions = {\n    prefix: '_fsts_',\n    expiration: '3600' // seconds\n};\n\nvar LocalStorage = function () {\n    function LocalStorage(options) {\n        babelHelpers.classCallCheck(this, LocalStorage);\n\n        logger.debug('creating LocalStorage instance', options);\n\n        this._options = Object.assign({}, defaultOptions, options);\n    }\n\n    babelHelpers.createClass(LocalStorage, [{\n        key: 'options',\n        value: function options(_options) {\n            if (_options) {\n                this._options = Object.assign({}, this._options, _options);\n            }\n\n            return this._options;\n        }\n    }, {\n        key: 'key',\n        value: function key(_key) {\n            return this._options.prefix + _key;\n        }\n    }, {\n        key: 'set',\n        value: function set(key, value) {\n            if (!key) {\n                logger.warn('no key to set');\n                return;\n            }\n            if (JS.isUndefined(value) || value === null) {\n                logger.worn('nothing to set for ' + key);\n                return;\n            }\n\n            var item = {\n                data: JSON.stringify(value),\n                ts: JS.ts()\n            };\n\n            this._setItem(key, item);\n        }\n    }, {\n        key: 'get',\n        value: function get(key) {\n            if (!key) {\n                logger.warn('no key to get');\n                return;\n            }\n\n            var item = this._getItem(key);\n            if (!item) {\n                logger.verbose('cache miss: ' + key);\n                return null;\n            }\n\n            if (this._isExpired(item)) {\n                logger.verbose('cache miss: ' + key);\n                return null;\n            }\n\n            logger.verbose('cache hit: ' + key);\n            return JSON.parse(item.data);\n        }\n    }, {\n        key: 'remove',\n        value: function remove(key) {\n            if (!key) {\n                logger.warn('no key to remove');\n                return;\n            }\n\n            this._removeItem(key);\n        }\n    }, {\n        key: 'clear',\n        value: function clear() {\n            var store = window.localStorage;\n            while (store.length > 0) {\n                var key = store.key(0);\n                store.removeItem(key);\n            }\n        }\n    }, {\n        key: 'purgeExpired',\n        value: function purgeExpired() {\n            var store = window.localStorage;\n            while (store.length > 0) {\n                var key = store.key(0);\n                var item = JSON.parse(store.getItem(key));\n                if (this._isExpired(item)) {\n                    store.removeItem(key);\n                }\n            }\n        }\n    }, {\n        key: '_setItem',\n        value: function _setItem(key, item) {\n            window.localStorage.setItem(this.key(key), JSON.stringify(item));\n        }\n    }, {\n        key: '_getItem',\n        value: function _getItem(key) {\n            var item = window.localStorage.getItem(this.key(key));\n            if (!item) {\n                return null;\n            }\n\n            var it = JSON.parse(item);\n            return {\n                data: it.data,\n                ts: it.ts * 1\n            };\n        }\n    }, {\n        key: '_removeItem',\n        value: function _removeItem(key) {\n            window.localStorge.removeItem(this.key(key));\n        }\n    }, {\n        key: '_isExpired',\n        value: function _isExpired(item) {\n            var cur = JS.ts();\n            return item.ts + this._options.expiration * 1000 < cur;\n        }\n    }]);\n    return LocalStorage;\n}();\n\nexport default LocalStorage;","import JS from '../JS';\nimport Logger from '../logger';\n\nvar logger = new Logger('MemoryStorage');\n\nvar defaultOptions = {\n    expiration: '3600' // seconds\n\n\n    /**\n    * MemoryStorage as an alternative to LocalStorage. Items will not live beyond session.\n    * Still do JSON stringify so consistant with LocalStorage, also ensures immutable in cache.\n    */\n};\nvar MemoryStorage = function () {\n    function MemoryStorage(options) {\n        babelHelpers.classCallCheck(this, MemoryStorage);\n\n        logger.debug('creating MemoryStorage instance', options);\n\n        this._options = Object.assign({}, defaultOptions, options);\n\n        this._store = {};\n    }\n\n    babelHelpers.createClass(MemoryStorage, [{\n        key: 'options',\n        value: function options(_options) {\n            if (_options) {\n                this._options = Object.assign({}, this._options, _options);\n            }\n\n            return this._options;\n        }\n    }, {\n        key: 'set',\n        value: function set(key, value) {\n            if (!key) {\n                logger.warn('no key to set');\n                return;\n            }\n            if (JS.isUndefined(value) || value === null) {\n                logger.worn('nothing to set for ' + key);\n                return;\n            }\n\n            var item = {\n                data: JSON.stringify(value),\n                ts: JS.ts()\n            };\n\n            this._store[key] = item;\n        }\n    }, {\n        key: 'get',\n        value: function get(key) {\n            if (!key) {\n                logger.warn('no key to get');\n                return;\n            }\n\n            var item = this._store[key];\n            if (!item) {\n                logger.verbose('cache miss: ' + key);\n                return null;\n            }\n\n            if (this._isExpired(item)) {\n                logger.verbose('cache miss: ' + key);\n                return null;\n            }\n\n            logger.verbose('cache hit: ' + key);\n            return JSON.parse(item.data);\n        }\n    }, {\n        key: 'remove',\n        value: function remove(key) {\n            if (!key) {\n                logger.warn('no key to remove');\n                return;\n            }\n\n            delete this._store[key];\n        }\n    }, {\n        key: 'clear',\n        value: function clear() {\n            this._store = {};\n        }\n    }, {\n        key: 'purgeExpired',\n        value: function purgeExpired() {\n            var _this = this;\n\n            Object.keys(this._store).forEach(function (key) {\n                var item = _this._store[key];\n                if (_this._isExpired(item)) {\n                    delete _this._store[key];\n                }\n            });\n        }\n    }, {\n        key: '_isExpired',\n        value: function _isExpired(item) {\n            var cur = JS.ts();\n            return item.ts + this._options.expiration * 1000 < cur;\n        }\n    }]);\n    return MemoryStorage;\n}();\n\nexport default MemoryStorage;","import Device from '../Device';\n\nimport { default as LocalStorage } from './LocalStorage';\nimport { default as MemoryStorage } from './MemoryStorage';\n\nvar _instance = Device.hasWindow() ? new LocalStorage() : new MemoryStorage();\n\nexport default _instance;\n\nexport { LocalStorage, MemoryStorage };","import Device from '../Device';\nimport Logger from '../logger';\n\nvar logger = new Logger('SSO.Google');\n\nvar default_options = {\n    google_client_id: null,\n    script: 'https://apis.google.com/js/platform.js',\n    scope: 'profile email openid'\n\n    /**\n    * Reference: https://developers.google.com/identity/sign-in/web/reference\n    */\n};\nvar Google = function () {\n    function Google(options) {\n        babelHelpers.classCallCheck(this, Google);\n\n        if (typeof options === 'string') {\n            options = { google_client_id: options };\n        }\n        this._options = Object.assign({}, default_options, options);\n        if (!this._options.google_client_id) {\n            logger.warn('missing google_client_id');\n        }\n\n        this.signIn = this.signIn.bind(this);\n        this.signOut = this.signOut.bind(this);\n        this.check = this.check.bind(this);\n        this.ready = this.ready.bind(this);\n\n        this._initGapi = this._initGapi.bind(this);\n        this._user = this._user.bind(this);\n\n        this._ga = null;\n\n        this._createScript();\n    }\n\n    babelHelpers.createClass(Google, [{\n        key: 'signIn',\n        value: function signIn() {\n            var _this = this;\n\n            if (!this._ga) {\n                return Promise.reject('no ga instance');\n            }\n\n            return this._ga.signIn().then(function (googleUser) {\n                return _this._user(googleUser);\n            });\n        }\n    }, {\n        key: 'signOut',\n        value: function signOut() {\n            if (!this._ga) {\n                return Promise.reject('no ga instance');\n            }\n\n            return this._ga.signOut();\n        }\n    }, {\n        key: 'check',\n        value: function check() {\n            var _this2 = this;\n\n            if (!this._ga) {\n                return Promise.reject('no ga instance');\n            }\n\n            return new Promise(function (resolve, reject) {\n                var googleUser = _this2._ga.currentUser.get();\n                if (!googleUser) {\n                    reject('no google user');\n                    return;\n                }\n                if (googleUser.isSignedIn()) {\n                    resolve(_this2._user(googleUser));\n                } else {\n                    reject('not signed in');\n                }\n            });\n        }\n    }, {\n        key: 'ready',\n        value: function ready() {\n            var google_client_id = this._options.google_client_id;\n\n            if (!google_client_id) {\n                return Promise.reject('missing google_client_id in options');\n            }\n\n            var that = this;\n            return new Promise(function (resolve, reject) {\n                var checkCount = 0;\n                var checkGA = function checkGA() {\n                    checkCount++;\n                    if (that._ga) {\n                        resolve();\n                        return;\n                    }\n\n                    if (window.gapi) {\n                        that._initGapi();\n                        return;\n                    }\n\n                    if (checkCount < 5) {\n                        window.setTimeout(checkGA, 500);\n                    } else {\n                        reject('timeout');\n                    }\n                };\n                checkGA();\n            });\n        }\n    }, {\n        key: '_user',\n        value: function _user(googleUser) {\n            var _googleUser$getAuthRe = googleUser.getAuthResponse(),\n                id_token = _googleUser$getAuthRe.id_token;\n\n            var profile = googleUser.getBasicProfile();\n            return {\n                id_token: id_token,\n                email: profile.getEmail(),\n                name: profile.getName()\n            };\n        }\n    }, {\n        key: '_createScript',\n        value: function _createScript() {\n            if (window.gapi) {\n                this._initGapi();\n                return;\n            }\n\n            var script = this._options.script;\n\n            if (script === 'none') {\n                return;\n            }\n\n            var src = this._options.script;\n            Device.createScript(src, true, this._initGapi);\n        }\n    }, {\n        key: '_initGapi',\n        value: function _initGapi() {\n            logger.debug('init gapi');\n            var _options = this._options,\n                google_client_id = _options.google_client_id,\n                scope = _options.scope;\n\n            if (!google_client_id) {\n                logger.warn('missing google_client_id in options');\n                return;\n            }\n\n            var that = this;\n            var g = window.gapi;\n            g.load('auth2', function () {\n                g.auth2.init({\n                    client_id: google_client_id,\n                    scope: scope\n                }).then(function (ga) {\n                    that._ga = ga;\n                });\n            });\n        }\n    }]);\n    return Google;\n}();\n\nexport default Google;","import Device from '../Device';\nimport Logger from '../logger';\n\nvar logger = new Logger('SSO.Facebook');\n\nvar default_options = {\n    facebook_app_id: null,\n    script: 'https://connect.facebook.net/en_US/sdk.js',\n    scope: 'public_profile,email'\n\n    /**\n    * Reference: https://developers.facebook.com/docs/reference/javascript/FB.getLoginStatus\n    */\n};\nvar Facebook = function () {\n    function Facebook(options) {\n        babelHelpers.classCallCheck(this, Facebook);\n\n        if (typeof options === 'string') {\n            options = { facebook_app_id: options };\n        }\n        this._options = Object.assign({}, default_options, options);\n        if (!this._options.facebook_app_id) {\n            logger.warn('missing facebook_app_id');\n        }\n\n        this.signIn = this.signIn.bind(this);\n        this.signOut = this.signOut.bind(this);\n        this.check = this.check.bind(this);\n        this.ready = this.ready.bind(this);\n\n        this._fbAsyncInit = this._fbAsyncInit.bind(this);\n        this._user = this._user.bind(this);\n\n        this._fb = null;\n\n        this._createScript();\n    }\n\n    babelHelpers.createClass(Facebook, [{\n        key: 'signIn',\n        value: function signIn() {\n            var _this = this;\n\n            var fb = this._fb;\n            if (!fb) {\n                return Promise.reject('no fb instance');\n            }\n\n            var scope = this._options.scope;\n\n            return this.check().then(function (authResponse) {\n                return _this._user(authResponse);\n            }).catch(function (err) {\n                return new Promise(function (resolve, reject) {\n                    fb.login(function (response) {\n                        resolve(_this._user(response.authResponse));\n                    }, { scope: scope });\n                });\n            });\n        }\n    }, {\n        key: 'signOut',\n        value: function signOut() {\n            var fb = this._fb;\n            if (!fb) {\n                return Promise.reject('no fb instance');\n            }\n\n            return new Promise(function (resolve, reject) {\n                fb.logout(function (response) {\n                    logger.debug('signed out', response);\n                    resolve();\n                });\n            });\n        }\n    }, {\n        key: 'check',\n        value: function check() {\n            var fb = this._fb;\n            if (!fb) {\n                return Promise.reject('no fb instance');\n            }\n\n            return new Promise(function (resolve, reject) {\n                fb.getLoginStatus(function (response) {\n                    if (response.status === 'connected') {\n                        resolve(response.authResponse);\n                    } else {\n                        reject(response);\n                    }\n                });\n            });\n        }\n    }, {\n        key: 'ready',\n        value: function ready() {\n            var facebook_app_id = this._options.facebook_app_id;\n\n            if (!facebook_app_id) {\n                return Promise.reject('missing facebook_app_id in props');\n            }\n\n            var that = this;\n            return new Promise(function (resolve, reject) {\n                var checkCount = 0;\n                var checkFB = function checkFB() {\n                    checkCount++;\n                    if (that._fb) {\n                        resolve();\n                        return;\n                    }\n\n                    if (window.FB) {\n                        that._fb = window.FB;\n                        resolve();\n                        return;\n                    }\n\n                    if (checkCount < 5) {\n                        window.setTimeout(checkFB, 500);\n                    } else {\n                        reject('timeout');\n                    }\n                };\n                checkFB();\n            });\n        }\n    }, {\n        key: '_user',\n        value: function _user(authResponse) {\n            if (!authResponse) {\n                return Promise.reject('no authResponse');\n            }\n            var accessToken = authResponse.accessToken,\n                userID = authResponse.userID;\n\n            if (!accessToken) {\n                return Promise.reject('no accessToken');\n            }\n\n            var fb = this._fb;\n            return new Promise(function (resolve, reject) {\n                fb.api('/me', function (response) {\n                    var user = {\n                        accessToken: accessToken,\n                        userID: userID,\n                        name: response.name\n                    };\n\n                    logger.debug('user', user);\n                    resolve(user);\n                });\n            });\n        }\n    }, {\n        key: '_fbAsyncInit',\n        value: function _fbAsyncInit() {\n            logger.debug('init FB');\n\n            var facebook_app_id = this._options.facebook_app_id;\n\n            if (!facebook_app_id) {\n                logger.warn('missing facebook_app_id in props');\n                return;\n            }\n\n            var fb = window.FB;\n            fb.init({\n                appId: facebook_app_id,\n                cookie: true,\n                xfbml: true,\n                version: 'v2.11'\n            });\n            this._fb = fb;\n        }\n    }, {\n        key: '_createScript',\n        value: function _createScript() {\n            if (window.FB) {\n                this._fbAsyncInit();\n                return;\n            }\n\n            var script = this._options.script;\n\n            if (script === 'none') {\n                if (window.FB) {\n                    this._fb = window.FB;\n                }\n                return;\n            }\n\n            window.fbAsyncInit = this._fbAsyncInit;\n            Device.createScript(this._options.script, true);\n        }\n    }]);\n    return Facebook;\n}();\n\nexport default Facebook;","import Device from '../Device';\nimport Logger from '../logger';\n\nvar logger = new Logger('SSO.LinkedIn');\n\nvar default_options = {\n    api_key: null,\n    script: 'http://platform.linkedin.com/in.js?async=true'\n\n    /**\n    * Reference: https://developer.linkedin.com/docs/getting-started-js-sdk\n    */\n};\nvar LinkedIn = function () {\n    function LinkedIn(options) {\n        babelHelpers.classCallCheck(this, LinkedIn);\n\n        if (typeof options === 'string') {\n            options = { api_key: options };\n        }\n        this._options = Object.assign({}, default_options, options);\n        if (!this._options.api_key) {\n            logger.warn('missing api_key');\n        }\n\n        this.signIn = this.signIn.bind(this);\n        this.signOut = this.signOut.bind(this);\n        this.check = this.check.bind(this);\n        this.ready = this.ready.bind(this);\n\n        this._user = this._user.bind(this);\n        this._initIn = this._initIn.bind(this);\n        this._fullyLoaded = this._fullyLoaded.bind(this);\n\n        this._IN = null;\n        this._INLoaded = false;\n\n        this._createScript();\n    }\n\n    babelHelpers.createClass(LinkedIn, [{\n        key: 'signIn',\n        value: function signIn() {\n            var IN = this._IN;\n            if (!IN) {\n                return Promise.reject('no IN instance');\n            }\n\n            var that = this;\n            return new Promise(function (resolve, reject) {\n                IN.User.authorize(function () {\n                    that._user().then(function (user) {\n                        return resolve(user);\n                    }).catch(function (err) {\n                        return reject(err);\n                    });\n                });\n            });\n        }\n    }, {\n        key: 'signOut',\n        value: function signOut() {\n            var IN = this._IN;\n            if (!IN) {\n                return Promise.reject('no IN instance');\n            }\n\n            var that = this;\n            return new Promise(function (resolve, reject) {\n                IN.User.logout(function () {\n                    logger.debug('signed out');\n                    resolve();\n                });\n            });\n        }\n    }, {\n        key: 'check',\n        value: function check() {\n            var IN = this._IN;\n            if (!IN) {\n                return Promise.reject('no IN instance');\n            }\n\n            if (!IN.User.isAuthorized()) {\n                return Promise.reject('not authorized');\n            }\n\n            return this._user();\n        }\n    }, {\n        key: 'ready',\n        value: function ready() {\n            var api_key = this._options.api_key;\n\n            if (!api_key) {\n                return Promise.reject('missing api_key');\n            }\n\n            var that = this;\n            return new Promise(function (resolve, reject) {\n                var checkCount = 0;\n                var checkIN = function checkIN() {\n                    checkCount++;\n                    if (that._IN && that._INLoaded) {\n                        resolve();\n                        return;\n                    }\n\n                    if (window.IN) {\n                        that._initIn();\n                        return;\n                    }\n\n                    if (checkCount < 5) {\n                        window.setTimeout(checkIN, 500);\n                    } else {\n                        reject('timeout');\n                    }\n                };\n                checkIN();\n            });\n        }\n    }, {\n        key: '_user',\n        value: function _user() {\n            var IN = this._IN;\n            return new Promise(function (resolve, reject) {\n                IN.API.Raw('/people/~').result(function (profile) {\n                    var firstName = profile.firstName,\n                        lastName = profile.lastName,\n                        id = profile.id,\n                        headline = profile.headline;\n\n                    resolve({\n                        id: id,\n                        firstName: firstName,\n                        lastName: lastName,\n                        headline: headline\n                    });\n                }).error(function (err) {\n                    return reject(err);\n                });\n            });\n        }\n    }, {\n        key: '_createScript',\n        value: function _createScript() {\n            if (window.IN) {\n                this._initIn();\n            }\n\n            var script = this._options.script;\n\n            if (script === 'none') {\n                return;\n            }\n\n            window._in_onload = this._fullyLoaded;\n            Device.createScript(this._options.script, true, this._initIn);\n        }\n    }, {\n        key: '_initIn',\n        value: function _initIn() {\n            logger.debug('init IN');\n            var api_key = this._options.api_key;\n\n            if (!api_key) {\n                logger.warn('missing api_key');\n                return;\n            }\n\n            var IN = window.IN;\n            IN.init({\n                api_key: api_key,\n                authorize: true,\n                onLoad: \"_in_onload\"\n            });\n            this._IN = IN;\n        }\n    }, {\n        key: '_fullyLoaded',\n        value: function _fullyLoaded() {\n            logger.debug('fully loaded');\n            this._INLoaded = true;\n        }\n    }]);\n    return LinkedIn;\n}();\n\nexport default LinkedIn;","import Google from './Google';\nimport Facebook from './Facebook';\nimport LinkedIn from './LinkedIn';\n\nvar SSO = {\n    Google: Google,\n    Facebook: Facebook,\n    LinkedIn: LinkedIn\n};\n\nexport default SSO;","import Logger from '../logger';\n\nvar logger = new Logger('Subscriber');\n\nvar Subscriber = function () {\n    function Subscriber(channel, noticeHandler) {\n        babelHelpers.classCallCheck(this, Subscriber);\n\n        this.channel = channel;\n        this.noticeHandler = noticeHandler;\n        this.cursor = -1;\n    }\n\n    babelHelpers.createClass(Subscriber, [{\n        key: 'notify',\n        value: function notify() {\n            var events = this.channel.poll(this.cursor);\n            this.cursor = channel.cursor;\n            if (events.length > 0) {\n                for (var i = 0; i < events.length; i++) {\n                    this._notifyEvent(events[i]);\n                }\n            }\n        }\n    }, {\n        key: '_notifyEvent',\n        value: function () {\n            var _ref = babelHelpers.asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(event) {\n                return regeneratorRuntime.wrap(function _callee$(_context) {\n                    while (1) {\n                        switch (_context.prev = _context.next) {\n                            case 0:\n                                try {\n                                    this.noticeHandler(event);\n                                } catch (e) {\n                                    logger.error('notify event error', e, event, this.noticeHandler);\n                                }\n\n                            case 1:\n                            case 'end':\n                                return _context.stop();\n                        }\n                    }\n                }, _callee, this);\n            }));\n\n            function _notifyEvent(_x) {\n                return _ref.apply(this, arguments);\n            }\n\n            return _notifyEvent;\n        }()\n    }]);\n    return Subscriber;\n}();\n\nexport default Subscriber;","import JS from '../JS';\nimport Logger from '../logger';\n\nimport Subscriber from './Subscriber';\n\nvar logger = new Logger('Channel');\n\nvar default_options = {\n    bufferSize: 128\n};\n\nvar Channel = function () {\n    function Channel(name, options) {\n        babelHelpers.classCallCheck(this, Channel);\n\n        this.name = name;\n        this.events = [];\n        this.subscribers = [];\n        this.cursor = -1;\n\n        this._options = Object.assign({}, default_options, options);\n    }\n\n    babelHelpers.createClass(Channel, [{\n        key: 'subscribe',\n        value: function subscribe(noticeHandler) {\n            var found = this.subscribers.filter(function (subscriber) {\n                return subscriber.noticeHandler === noticeHandler;\n            });\n            if (found.length > 0) {\n                logger.debug('duplicated subscription on channel ' + this.name, noticeHandler);\n                return;\n            }\n\n            var subscriber = new Subscriber(this, noticeHandler);\n            this.subscribers.push(subscriber);\n            subscriber.notify();\n        }\n    }, {\n        key: 'unsubscribe',\n        value: function unsubscribe(noticeHandler) {\n            this.subscribers = this.subscribers.filter(function (subscriber) {\n                return subscriber.noticeHandler !== noticeHandler;\n            });\n        }\n    }, {\n        key: 'send',\n        value: function send(event) {\n            if (!event) {\n                logger.warn('nothing to send to channel ' + this.name);\n            }\n\n            var size = this._options.bufferSize;\n            this.cursor++;\n            var idx = this.cursor % size;\n            if (idx < this.events.length) {\n                this.events[idx] = event;\n            } else {\n                this.events.push(event);\n            }\n\n            this.subscribers.forEach(function (subscriber) {\n                return subscriber.notify();\n            });\n        }\n    }, {\n        key: 'poll',\n        value: function poll(last_cursor) {\n            if (JS.isUndefined(lastCursor)) {\n                last_cursor = -1;\n            }\n            if (last_cursor === this.cursor) {\n                return [];\n            }\n\n            var list = [];\n            var size = this._options.bufferSize;\n            for (var i = last_cursor + 1; i <= this.cursor; i++) {\n                var idx = i % size;\n                if (idx >= this.events.length) {\n                    logger.error('idx overflow');\n                    break;\n                }\n                list.push(this.events[idx]);\n            }\n\n            return list;\n        }\n    }]);\n    return Channel;\n}();\n\nexport default Channel;","import Logger from '../logger';\nimport Channel from './Channel';\n\nvar logger = new Logger('Pipe');\n\nvar default_options = {\n    bufferSize: 128\n};\n\nvar CHANNEL_BROADCAST = '_broadcast_';\n\nvar Pipe = function () {\n    function Pipe(name, options) {\n        babelHelpers.classCallCheck(this, Pipe);\n\n        this.name = name;\n        this._options = Object.assign({}, default_options, options);\n\n        this._channels = {};\n    }\n\n    babelHelpers.createClass(Pipe, [{\n        key: 'send',\n        value: function send(event, channel_name) {\n            if (!channel_name) {\n                channel_name = event.channel;\n            }\n            if (!channel_name) {\n                channel_name = CHANNEL_BROADCAST;\n            }\n            var channel = this._getChannel(channel_name);\n\n            channel.send(event);\n        }\n    }, {\n        key: 'subscribe',\n        value: function subscribe(noticeHandler, channel_name) {\n            if (!channel_name) {\n                channel_name = CHANNEL_BROADCAST;\n            }\n            var channel = this._getChannel(channel_name);\n\n            channel.subscribe(noticeHandler);\n        }\n    }, {\n        key: '_getChannel',\n        value: function _getChannel(name) {\n            if (!name) {\n                return null;\n            }\n            var channel = this._channels[name];\n            if (!channel) {\n                channel = new Channel(name);\n                this.channels[name] = channel;\n            }\n            return channel;\n        }\n    }]);\n    return Pipe;\n}();\n\nexport default Pipe;","import Pipe from './Pipe';\n\nvar pipe = new Pipe('_root_');\n\nexport default pipe;\n\nexport { Pipe };","var Url = function () {\n    function Url() {\n        babelHelpers.classCallCheck(this, Url);\n    }\n\n    babelHelpers.createClass(Url, null, [{\n        key: 'params',\n        value: function params(url) {\n            var parts = url.split('?');\n            if (parts.length < 2) {\n                return {};\n            }\n\n            parts = parts[1].split('#')[0].split('&');\n            var obj = {};\n            parts.forEach(function (part) {\n                var n_v = part.split('=');\n                var name = n_v[0];\n                var value = n_v.length > 1 ? n_v.slice(1).join('') : '';\n                obj[name] = decodeURIComponent(value);\n            });\n\n            return obj;\n        }\n    }]);\n    return Url;\n}();\n\nexport default Url;"],"names":["JS","classCallCheck","this","createClass","val","n","length","padNumber","cur","remain","Math","floor","s","i","props","less","p","Object","assign","concat","forEach","prop","regex","RegExp","keys","map","key","match","lookup","count","obj","callback","_traverseProps","log","path","babelHelpers","typeof","ary","filter","item","push","Date","getTime","defVal","isUndefined","LOG_LEVELS","ConsoleLogger","name","level","arguments","undefined","dt","getMinutes","getSeconds","join","getMilliseconds","type","msg","parts","_ts","level_name","LOG_LEVEL","window","logger_level","console","error","warn","_len","Array","_key2","_key","output","slice","_output","_output2","_len2","_key5","_log","apply","_len3","_key6","_len4","_key7","_len5","_key8","_len6","_key9","_len7","_key10","Logger","Device","src","async","onload","script","document","createElement","body","appendChild","logger","defaultOptions","LocalStorage","options","debug","_options","prefix","value","worn","JSON","stringify","ts","_setItem","_getItem","_isExpired","verbose","parse","data","_removeItem","store","localStorage","removeItem","getItem","setItem","it","localStorge","expiration","MemoryStorage","_store","_this","_instance","hasWindow","default_options","Google","google_client_id","signIn","bind","signOut","check","ready","_initGapi","_user","_ga","_createScript","then","googleUser","Promise","reject","_this2","resolve","currentUser","get","isSignedIn","that","checkCount","checkGA","gapi","setTimeout","id_token","getAuthResponse","profile","getBasicProfile","getEmail","getName","createScript","scope","g","load","auth2","init","ga","Facebook","facebook_app_id","_fbAsyncInit","_fb","fb","authResponse","catch","err","login","response","logout","getLoginStatus","status","checkFB","FB","accessToken","userID","api","user","fbAsyncInit","LinkedIn","api_key","_initIn","_fullyLoaded","_IN","_INLoaded","IN","User","authorize","isAuthorized","checkIN","API","Raw","result","firstName","lastName","id","headline","_in_onload","SSO","Subscriber","channel","noticeHandler","cursor","events","poll","_notifyEvent","_ref","asyncToGenerator","regeneratorRuntime","mark","_callee","event","wrap","_context","prev","next","e","stop","_x","Channel","subscribers","subscriber","notify","size","bufferSize","idx","last_cursor","lastCursor","list","CHANNEL_BROADCAST","Pipe","_channels","channel_name","_getChannel","send","subscribe","channels","pipe","Url","url","split","part","n_v","decodeURIComponent"],"mappings":"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"}